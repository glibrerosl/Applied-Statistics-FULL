---
title: "**Admisión en la Universidad**"
subtitle: "Datos para ser admitido en estudios superiores en EE.UU."
author: "Por: Giancarlo Libreros Londoño::glibrerosl@libertadores.edu.co"
date: "Estudio Multivariante Elaborado entre febrero y marzo de 2023 como actividad formativa y evaluativa del curso Análisis Multivariante de la especialización en Estadística Aplicada (modalidad virtual)."
output:
  html_document:
    toc: TRUE
    toc_float: TRUE
    code_download: TRUE
    theme: lumen
bibliography: bibliografia_ME.bib
csl: apa.csl
link-citations: yes
---
<!-- Configuración Global de R -->
```{r setup, include=FALSE}
library(readxl)
library(corrplot)
library(GGally)
library(ggplot2)
library(andrews)
library(tcltk)
library(aplpack)
library(graphics)
library(corrplot)
library(MVN)

knitr::opts_chunk$set(echo=TRUE)

Admission_Dataset <- read_excel("D:/ZB/[2] Academicas/[10.1] Especializacion/[0] Cursos/[3] Ans_Multivariante/Tareas/Admission_Dataset.xlsx")
Admission_Dataset_Initial <- read_excel("D:/ZB/[2] Academicas/[10.1] Especializacion/[0] Cursos/[3] Ans_Multivariante/Tareas/Admission_Dataset_Initial.xlsx")
```

## **1. Objetivo y Anotaciones**
En términos generales, esta primera etapa de estudio mostrará cálculos, visualizaciones e interpretaciones con base en un conjunto de datos desde un enfoque de estadística descriptiva multivariante; además, de incluir una prueba estadística de normalidad multivariada sobre ellos.

El conjunto de datos de trabajo es descrito en la sección **2**. Cabe anotar que los fundamentos teóricos provienen de notas de clase del curso **Análisis Multivariante** dictado por el profesor Juan Carlos Rubriche Cárdenas para la Especialización en Estadística Aplicada, modalidad virtual (cohorte 2022-4), de la Fundación Universitaria Los Libertadores; y de los libros: Análisis Multivariante Aplicado con R [@AMARAldas-Uriel2ed] de Joaquín Aldás y Ezequiel Uriel, Análisis Multivariante de Joseph Hair, Rolph Anderson, Ronald Tatham y William Black [@AMHair-etAl5ed], Análisis Estadístico de Datos Multivariados de Luis Guillermo Díaz Monroy y Mario Alfonso Morales Rivera [@AEDMDiaz-Morales1ed], e Introducción a la Teoría Matemática de las Probabilidades y a la Estadística de Howard Tucker [@ITMPETucker1ed].

Este trabajo continúa el hecho en el curso **Análisis de Regresión** dictado por el profesor Dagoberto Bermúdez para la Especialización en Estadística Aplicada, modalidad virtual (cohorte 2022-4), de la Fundación Universitaria Los Libertadores. En este la bibliografía consultada fue: probabilidad y estadística de Jay L. Devore [@PEDevore7ed], Bioestadística de Wayne W. Daniel [@BEDaniel4ed], Métodos Matemáticos de Estadística de Harald Cramer [@MMECramer1ed]; motivo por el cual se incluyen en las referencias. El trabajo hecho en Análisis de Regresión podrá ser consultado próximamente a través de: https://glibrerosl.github.io/Applied-Statistics-FULL/.

Por último, este trabajo fue procesado con `r R.version.string` mediado por RStudio 2022.12.0 Build 353 en una plataforma x86_64-w64-mingw32. Además, por su naturaleza de publicación en línea y para cumplir con el requisito temporal de entrega, será actualizado, como máximo, hasta las 11:59 p.m. del lunes 13 de febrero de 2023.

## **2. Descripción de los Datos**

### 2.1. Fuente del Conjunto de Datos
El conjunto de datos de trabajo se obtuvo casi totalmente de **Kaggle**: https://www.kaggle.com/akshaydattatraykhare. Es conveniente anotar que **Kaggle** es una compañía subsidiaria de Google LLC que mantiene una comunidad online de científicos de datos y profesionales del aprendizaje automático. Esta empresa permite a sus usuarios encontrar y publicar conjuntos de datos, explorar y crear modelos en un entorno de ciencia de datos basado en la web, trabajar con otros científicos de datos e ingenieros de aprendizaje automático y participar en concursos para resolver desafíos de ciencia de datos.

### 2.2. Contexto del Conjunto de Datos
El conjunto de datos incluye métricas académicas obtenidas por estudiantes extranjeros para aspirar a acceder a universidades de EE.UU. Este conjunto de datos se actualizó por última vez en julio de 2022.

### 2.3. Descripción del Conjunto de Datos {.tabset .tabset-pills}
El conjunto de datos contiene 10 campos y 400 registros. Uno de los campos es simplemente un identificador numérico secuencial de los registros; otros tres son de naturaleza politómica; y el resto son numéricos estrictamente positivos. La lista siguiente los describe en el mismo orden, de izquierdda a derecha, como aparecen en el rango de datos que los contiene y se establece para cada campo, excepto el campo **Serial**, el tipo de variable y su escala de medición con base en la nomenclatura (tipo_de_variable::escala_de_medición[ordenamiento]):

- **Serial** (identificador): registra un número secuenciado a partir de 1 para identificar de forma única cada registro consignado en el conjunto de datos.

- **Gender** (cualitativa::nominal): registra el sexo del estudiante del cual se registraron los datos: 1 corresponde con un estudiante de sexo masculino, 0 con un estudiante de sexo femenino.

- **GRE Score** (cuantitativa::razón): registra el puntaje total GRE (examen de acceso a la universidad) obtenido por el estudiante. GRE es un componente común del proceso de admisión a colegios o universidades en EE.UU. que mide el razonamiento verbal, cuantitativo, la escritura analítica y las habilidades de pensamiento crítico que se han adquirido a lo largo de un extenso período de tiempo y que no están relacionados con campo específicos de estudio. El campo solo registra dos de los tres componentes de la evaluación: razonamiento verbal y cuantitativo, en una escala desde 260 hasta 340 puntos. El resultado ausente del puntaje corresponde con el componente de escritura analítica: calificado entre 0 y 6 puntos.

- **TOEFL Score** (cuantitativa::razón): registra el puntaje total TOEFL (prueba de inglés como idioma extranjero) obtenido por el estudiante. TOEFL es un componente común del proceso de admisión a colegios o universidades en EE.UU. por parte de estudiantes extranjeros que mide las competencias en comprensión escrita, comprensión oral, expresión oral y expresión escrita, en una escala desde 0 hasta 120 puntos.

- **SOP** (cuantitativa::razón): registra el puntaje total SOP (ensayo de declaración de propósitos o de admisión) obtenido por el estudiante. SOP es un componente común del proceso de admisión a colegios o universidades en EE.UU. que consiste en un ensayo de solicitud de ingreso escrito por el estudiante en el cual debe hacer una descripción general de quién es, en quién quiere convertirse y hasta qué punto está preparado para seguir un determinado curso en la institución educativa a la cual aspira ingresar. Este ensayo se califica con un puntaje entre 0 y 5.

- **LOR** (cuantitativa::razón): registra el puntaje total LOR (carta de recomendación) obtenido por el estudiante. LOR es un componente común del proceso de admisión a colegios o universidades en EE.UU. que consiste en una recomendación escrita, generalmente por un profesor, en la cual el redactor evalúa las cualidades, características y capacidades del estudiante recomendado en relación con su aptitud para seguir un curso en la institución educativa a la cual el estudiante aspira a ingresar. Esta carta se califica con un puntaje entre 0 y 5.

- **CGPA** (cuantitativa::razón): registra el puntaje total CGPA (promedio de calificaciones acumulativo) obtenido por el estudiante. CGPA es un componente común del proceso de admisión a colegios o universidades en EE.UU. que mide el desempeño promedio del estudiante en su escolaridad previa a la solicitud de ingreso a la institución educativa siguiente de su preferencia. Este puntaje se mide entre 0 y 4; sin embargo, en el conjunto de datos fue convertido en una escala entre 0 y 10.

- **Research** (cualitativa::nominal): registra la experiencia en investigación que posee el estudiante: 1 corresponde con que el estudiante argumenta experiencia investigativa, 0 corresponde con que no-argumenta experiencia investigativa.

- **University Rating** (cualitativa::nominal(ordenada)): registra valoración de la universidad a la cual aspira a ingresar el estudiante. Esta valoración se hace en una escala entre 1 y 5 estrellas, cinco estrellas indica la mejor valoración.

- **Chance of Admit** (cuantitativa::razón): registra la probabilidad de que el estudiante sea admitido en la universidad de su preferencia con base en los datos registrados a su nombre, salvo su sexo. Esta probrabilidad se mide entre 0 y 1.

Por último, es necesario aclarar que en el conjunto de datos los registros de las variables cualitativas fueron reescritos, según los casos, por números enteros positivos, incluido el cero. Así, los sexos en la variable **Gender** fueron reescritos como **0**:**female** y **1**:**male**; en **Research** el evidenciar o no-evidenciar investigaciones fue reescrito como **0**:**no-research** y **1**:**research**; y en **University Rating** la valoración de la universidad fue reescrita como **1**:**one_star**, **2**:**two_stars**, **3**:**three_stars**, **4**:**four_stars** y **5**:**five_stars**.

#### Estructura del Conjunto de Datos Inicial
```{r Estructura_Conjunto_de_Datos_Inicial, fig.align = 'center'}
str(Admission_Dataset_Initial)
```

#### Conjunto de Datos Inicial
```{r Conjunto_de_Datos_Inicial, fig.align = 'center'}
Admission_Dataset_Initial
```

#### Estructura del Conjunto de Datos Reescrito
```{r Estructura_Conjunto_de_Datos_Reescrito, fig.align = 'center'}
str(Admission_Dataset)
```

#### Conjunto de Datos Reescrito
```{r Conjunto_de_Datos_Reescrito, fig.align = 'center'}
Admission_Dataset
```

## **3. Estimaciones Multivariadas**
[párrafo de entrada].

### 3.1. Planteamiento del Problema
Con base en el conjunto de datos descrito en la sección **2** se calcularán e intepretarán, para las variables numéricas, el vector de medias, la matriz de covarianzas y la matriz de correlaciones. Se recuerda que las variables numéricas (en escalada de medición de razón) son: **GRE Score**, **TOEFL Score**, **SOP**, **LOR**, **CGPA** y **Chance of Admit**.

### 3.2. Desarrollo del Análisis {.tabset .tabset-pills}

La navegación a través de las pestañas muestra el cálculo de los siguientes objetos: **Vector de Medias** $\bar x$, **Matriz de Covarianzas** $S$ y **Matriz de Correlaciones** $R$.

Con base en la pestaña **Vector de Medias** se puede comentar que...

Con base en la pestaña **Matriz de Covarianzas** se interpreta que...

Con base en la pestaña **Matriz de Correlaciones** se entiende que...

Complementariamente, ...

#### Vector de Medias
```{r vector_de_Medias, fig.align = 'center'}
apply(Admission_Dataset[,-c(1,2,8,9)], 2, mean)
```

#### Matriz de Covarianzas
```{r matriz_de_Covarianzas, fig.align = 'center'}
round(cov(Admission_Dataset[,-c(1,2,8,9)]),2)
```

#### Matriz de Correlaciones
```{r matriz_de_Correlaciones, fig.align = 'center'}
round(cor(Admission_Dataset[,-c(1,2,8,9)]),2)
```

## **4. Gráficas Multivariadas**
En la guía de clase de [@AMEDAristizabal2017] se menciona que, en general, los gráficos multivariados cumplen dos objetivos esenciales: primero, ayudan a comparar	el	comportamiento	de	poblaciones de estudio con base en variables categóricas y suavizan la comprensión de la estructura de correlación entre	varias variables. En este sentido, el conjunto de datos de trabajo tendrá apoyo descritivo gráfico a través de tres diagramas: uno conjunto que integra dispersión, distribución y correlaciones; otro basado en la renderización de polígonos, y por último, uno que recurre a las caras de Chernoff.



### 4.1. Planteamiento del Problema
Con base en el conjunto de datos descrito en la sección **2** se calcularán e intepretarán, para las variables numéricas, las gráficas multivariadas de diagrama de correlaciones, matriz de diagrama de dispersión, diagrama de estrellas y caras de Chernoff. Se recuerda que las variables numéricas (en escalada de medición de razón) son: **GRE Score**, **TOEFL Score**, **SOP**, **LOR**, **CGPA** y **Chance of Admit**.

### 4.2. Desarrollo del Análisis {.tabset .tabset-pills}
La navegación a través de las pestañas muestra las gráficas multivariadas de: **dispersión**, **distribución**, **correlaciones**, **estrellas** y **caras de Chernoff**.

Con base en la pestaña **Diagrama Conjunto de Dispersión, Distribución y Correlaciones** se puede comentar que...

Con base en la pestaña **Diagrama de Estrellas** se interpreta que...

Con base en la pestaña **Caras de Chernoff** se entiende que...

Complementariamente, ...

#### Diagrama Conjunto de Dispersión, Distribución y Correlaciones
```{r Diagrama_Conjunto_DDC, fig.align = 'center'}
ggpairs(Admission_Dataset[,-c(1,2,8,9)])
```

#### Diagrama de Estrellas
```{r diagrama_de_Estrellas, fig.align = 'center'}
set.seed(780728)
Admission_Dataset_Muestreado = Admission_Dataset[sample(1:nrow(Admission_Dataset),23),-c(1,2,8,9)]
stars(Admission_Dataset_Muestreado, len = 1, cex = 0.4, key.loc = c(10, 2), draw.segments = TRUE)
```

#### Caras de Chernoff
```{r caras_de_Chernoff, fig.align = 'center'}
set.seed(780728)
Admission_Dataset_Muestreado = Admission_Dataset[sample(1:nrow(Admission_Dataset),23),-c(1,2,8,9)]
faces(Admission_Dataset_Muestreado)
```

## **5. Normalidad Multivariada**
Como menciona [@CPEMPorras2016] para indagar o establecer el tipo de distribución multivariada de un conjunto de datos se puede recurrir a procedimientos descriptivos, como los gráficos, o a procedimientos inferenciales, como las pruebas estadísticas. En este sentido, se alcanza generalización de resultados al usar las estos últimos, si bien los primeros apoyan a las interpretaciones.

En este apartado se contempla el uso de procedimientos inferenciales para determinar si el conjunto de datos de trabajo, en relación con sus variables numéricas, se distribuye normal multivariado (DNM). Las pruebas de normalidad multivariada (PNM) a las que será sometido son: Mardia, Henze-Zirkler, Doornik-Hansen y Royston. Para estas pruebas de normalidad los test obedecen a un nivel de significancia $\alpha = 0.05$ y a las hipótesis:$$H_0: \text {Las variables tienen una DNM}$$ $$H_1: \text {Las variables NO tienen una DNM}$$ 

La prueba de Mardia se basa en extensiones de asimetría y curtosis, el cuadrado de la distancia de Mahalanobis, la cantidad de variables $p$ por tratar y la cantidad de registros $n$. Además, considera que la prueba estadística para la asimetría tiene una distribución $\chi^2$ y la prueba estadística para la curtosis se distirbuye aproximadamente normal. Los detalles sobre los parámetros de las distribuciones pueden consultarse en el trabajo de [@CPEMPorras2016].

La prueba de Henze-Zirkler se basa en la distancia funcional, dado que si el conjunto de datos presenta una distribución normal multivariada, el estadístico de la prueba se distribuye aproximadamente como una lognormal, cuyos parámetros de media $\mu$ y varianza $\sigma^2$ pueden ser consultados en [@CPEMPorras2016].

La prueba de Doornik-Hansen está basada en la asimetría y la curtosis de un conjunto de datos multivariados, que se transforma para garantizar la independencia. Es considerada más potente que la prueba de Shapiro-Wilk para casos multivariados. Su estadístico de prueba está definido como la suma de las transformaciones al cuadrado de la asimetría y la curtosis, y sigue, aproximadamente, una distribución $\chi^2$. Los detalles de la prueba pueden ser consultados en [@OTUMNDoornik_Hansen2008].

La prueba de Royston recurre a las pruebas Shapiro-Wilk o Shapiro-Francia para probar la normalidad multivariada. Así, si  la curtosis es mayor que 3, la prueba de Royston usa Shapiro-Francia para distribuciones leptocurticas. Mientras que para distribuciones platicurticas usa Shapiro-Wilk. En ella los parámetros son obtenidos por aproximaciones polinomiales, esto puede ser consultado en [@CPEMPorras2016].

### 5.1. Planteamiento del Problema
Con base en el conjunto de datos descrito en la sección **2** se hará una prueba estadística de normalidad multivariada, con un nivel de significancia $\alpha=0.05$, para establecer si sus datos métricos provienen de una población normal multivariada. Se recuerda que las variables numéricas del conjunto de datos (en escalada de medición de razón) son: **GRE Score**, **TOEFL Score**, **SOP**, **LOR**, **CGPA** y **Chance of Admit**.

### 5.2. Desarrollo del Análisis {.tabset .tabset-pills}
La navegación a través de las pestañas muestra que el conjunto de datos, en relación con sus variables numéricas, no se distribuye normal multivariado. En particular:

La **PNM de Mardia** establece que si ambas pruebas (para asimetría y curtosis) indican una normalidad multivariante, los datos siguen una DNM con un nivel de significancia $\alpha=0.05$; sin embargo, el caso tratado es contrario a esto. Obsérvese a través de la pestaña **PNM Mardia** que los $p-value$ para la asimetría (Skewness) y curtoris (Kurtosis) son mayores que el nivel de significancia. Por lo tanto, las evidencias no apoyan una hipótesis de normalidad multivariada para el conjunto de datos restringido a sus variables numéricas.

La **PNM de PNM Henze-Zirkler** establece que el estadístico de prueba no se distribuye aproximadamente como lognormal dado que su $p-value$ es menor que el nivel de significancia $\alpha=0.05$, obsérvese esto a través de la pestaña **PNM Henze-Zirkler**. Así, por contrarrecíproco de la implicación formulada en la descripción de la prueba en la sección 5, el conjunto de datos no está apoyado por las evidencias para seguir una distribución normal multivariada.

La **PNM de Doornik-Hansen** establece que su estadístico de prueba no sigue una distribución aproximadamente $\chi^2$ dado que su $p-value$ es menor que el nivel de significancia $\alpha=0.05$, obsérvese esto a través de la pestaña **PNM Doornik-Hansen**. Por lo tanto, las evidencias están lejos de apoyar que el conjunto de datos sigue una DNM.

La **PNM de Royston** establece que el conjunto de datos reducido a sus variables numéricas no sigue una DNM, dado que su $p-value$ es menor que el nivel de significancia $\alpha=0.05$. Obsérvese esto a través de la pestaña **PNM Royston**.

En general, pudo constatarse que para un nivel de significancia $\alpha=0.05$ el conjunto de datos reducido a sus variabls numéricas no sigue una distribución normal multivariada.

#### PNM Mardia
```{r PNM_Mardia, fig.align = 'center'}
mvn(Admission_Dataset[,-c(1,2,8,9)], mvnTest="mardia")
```

#### PNM Henze-Zirkler
```{r PNM_Henze_Zirkler, fig.align = 'center'}
mvn(Admission_Dataset[,-c(1,2,8,9)], mvnTest="hz")
```

#### PNM Doornik-Hansen
```{r PNM_Doornik_Hansen, fig.align = 'center'}
mvn(Admission_Dataset[,-c(1,2,8,9)], mvnTest="dh")
```

#### PNM Royston
```{r PNM_Royston, fig.align = 'center'}
mvn(Admission_Dataset[,-c(1,2,8,9)], mvnTest="royston")
```

## **Conclusiones**
Complementariamente a los análisis que fueron expuestos en las secciones de estudio es importante hacer una mención global sobre el problema considerado a la luz de todo lo obtenido:

...

## **Referencias**